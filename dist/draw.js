!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=13)}({0:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createId=function(t=""){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t+(e()+e()+"-")+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.wait=function(t=1e3){return new Promise(e=>{setTimeout(()=>{e()},t)})},e.createCanvas=(t,e,i)=>{const n=window.document.createElement("canvas");return n.id=t,n.width=e,n.height=i,n}},1:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(0);class s{constructor(t){this.type="draw",this.cashList=[],this.index=-1;const{container:e,type:i,lineWidth:n,onSync:s,lineColor:r}=t;this.containerWidth=e.offsetWidth,this.containerHeight=e.offsetHeight,this.type=i||"draw",this.lineColor=r||"#fff",this.lineWidth=n||10,this.onSync=s,this.initCanvas(e)}initCanvas(t){const e=n.createCanvas("draw",this.containerWidth,this.containerHeight);if("draw"===this.type){const t=this.action.bind(this,"start"),i=this.action.bind(this,"end"),n=t=>{this.action("move",t)};e.addEventListener("touchstart",t),e.addEventListener("mousedown",i=>{t(i),e.addEventListener("mousemove",n)}),e.addEventListener("touchmove",n),e.addEventListener("touchend",i),e.addEventListener("mouseup",t=>{i(t),e.removeEventListener("mousemove",n)})}t.appendChild(e),this.canvas=e,this.ctx=e.getContext("2d")}static getPoint(t){if(t.touches&&t.touches.length>0){const e=t.touches[0];return{x:e.clientX,y:e.clientY}}return{x:t.clientX,y:t.clientY}}setCtx(t={}){Object.keys(t).forEach(e=>{this.ctx[e]=t[e],"lineColor"===e&&(this.ctx.strokeStyle=t.lineColor)})}prepareCtx(){this.ctx.lineWidth=this.lineWidth,this.ctx.shadowBlur=1,this.ctx.shadowColor=this.lineColor,this.ctx.strokeStyle=this.lineColor,this.ctx.lineCap="round",this.ctx.lineJoin="round"}record(){this.cashList.push(this.canvas.toDataURL())}draw(t){const{type:e,point:i}=t;if(this.prepareCtx(),"start"===e)return this.ctx.beginPath(),this.ctx.fill(),this.ctx.moveTo(i.x-this.lineWidth/16,i.y-this.lineWidth/16),this.ctx.lineTo(i.x,i.y),this.ctx.stroke(),void this.record();if("move"===e)return this.ctx.lineTo(i.x,i.y),this.ctx.stroke(),void this.record();if("end"===e)return this.ctx.closePath(),void this.record();if("clear"===e)return this.index=-1,void this.clear();if("undo"===e){if(-1===this.index&&(this.index=this.cashList.length),0===this.index)return;this.index-=1,this.repaintByCashList()}if("redo"===e){if(this.index===this.cashList.length-1)return;this.index+=1,this.repaintByCashList()}}clear(){this.ctx.clearRect(0,0,this.containerWidth,this.containerHeight)}repaintByCashList(){const t=new Image;t.src=this.cashList[this.index],t.onload=()=>{this.clear(),this.ctx.drawImage(t,0,0,t.width,t.height)}}action(t,e){const i={type:t};e&&(i.point=s.getPoint(e)),this.onSync&&this.onSync(i),this.draw(i)}getImage(){return this.canvas.toDataURL("image/png")}}e.default=s},13:function(t,e,i){"use strict";i.r(e);var n=i(1),s=i.n(n);const r=new s.a({container:document.getElementById("webgl2"),type:"show"});new s.a({container:document.getElementById("webgl1"),onSync(t){r.draw(t)}})}});
//# sourceMappingURL=draw.js.map