{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./packages/utils/utils.ts","webpack:///./packages/Barrage/index.ts","webpack:///./src/danmu.js","webpack:///./packages/Barrage/Scene.ts","webpack:///./packages/Barrage/utils/TrackManager.ts","webpack:///./packages/Barrage/Sprite.ts","webpack:///./packages/Barrage/utils/loadImage.ts","webpack:///./packages/Barrage/utils/DrawManager.ts","webpack:///./packages/Barrage/utils/utils.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","createId","pre","S4","Math","random","toString","substring","wait","time","Promise","resolve","setTimeout","createCanvas","id","containerWidth","containerHeight","element","window","document","createElement","width","height","__importDefault","this","mod","Scene_1","Sprite_1","utils_1","utils_2","screenSpace","defaultGlobalConfig","type","lifeTime","defaultSpriteConfig","fontSize","fontColor","fontFamily","avatarSize","padding","radius","default","container","globalConfig","resize","calcData","canvas","templateCanvas","scene","resetGlobalConfig","mixConfig","initCanvas","templateCtx","getContext","ctx","assign","stop","start","clear","addEventListener","spriteConfig","getRandomColor","add","destroy","removeEventListener","isTemplate","offsetWidth","offsetHeight","style","position","display","append","trackRange","barrage","getElementById","count","timer","setInterval","content","avatar","clearInterval","TrackManager_1","spriteInstances","needAddSpriteList","run","tryToAddSprite","render","requestAnimationFrame","trackManger","rect","top","barrageWidth","speed","rangeWidth","speedX","sprite","push","setAnimation","calcAnimation","size","length","applyPosition","addSprite","shift","cancelAnimationFrame","clearRect","keys","forEach","uid","animation","removeEmployWithNotEmploy","status","e","drawTemplateCanvas","drawImage","employTrackSpaceY","employTrack","allTrack","spaceTracks","useTrack","map","range","split","parseFloat","sort","a","b","tracks","track","index","prevTrack","min","max","end","startTrack","undefined","spaceTrack","employ","values","employTrackPosition","getCanUseTrack","loadImage_1","DrawManager_1","employTrackSpaceX","getImageData","drawManager","draw","avatarImage","calcSize","left","checkEmployTrack","cacheImages","src","onload","onError","image","Image","crossOrigin","onerror","imageAndTextSpace","DrawManager","paddingTop","paddingRight","paddingBottom","paddingLeft","save","font","measureText","restore","barrageAllWidth","barrageAllHeight","floor","options","avatarSpaceTop","drawAvatar","img","imageHeight","imageWidth","textSpaceTop","drawText","drawBorder","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","strokeStyle","strokeRect","roundImageArgs","x","y","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","clip","fillStyle","textAlign","textBaseline","fillText","parseInt","String","config","defaultConfig"],"mappings":"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","file":"danmu.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction createId(pre = '') {\n    function S4() {\n        return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n    }\n    function guid() {\n        return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());\n    }\n    return pre + guid();\n}\nexports.createId = createId;\nfunction wait(time = 1000) {\n    return new Promise(resolve => {\n        setTimeout(() => {\n            resolve();\n        }, time);\n    });\n}\nexports.wait = wait;\nexports.createCanvas = (id, containerWidth, containerHeight) => {\n    const element = window.document.createElement('canvas');\n    element.id = id;\n    element.width = containerWidth;\n    element.height = containerHeight;\n    return element;\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ1dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLFNBQWdCLFFBQVEsQ0FBQyxNQUFjLEVBQUU7SUFDdkMsU0FBUyxFQUFFO1FBQ1QsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtJQUN4RSxDQUFDO0lBRUQsU0FBUyxJQUFJO1FBQ1gsT0FBTyxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxHQUFHLEdBQUcsR0FBRyxFQUFFLEVBQUUsR0FBRyxHQUFHLEdBQUcsRUFBRSxFQUFFLEdBQUcsR0FBRyxHQUFHLEVBQUUsRUFBRSxHQUFHLEdBQUcsR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFBO0lBQ3hGLENBQUM7SUFFRCxPQUFPLEdBQUcsR0FBRyxJQUFJLEVBQUUsQ0FBQTtBQUNyQixDQUFDO0FBVkQsNEJBVUM7QUFFRCxTQUFnQixJQUFJLENBQUMsT0FBZSxJQUFJO0lBQ3RDLE9BQU8sSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUU7UUFDM0IsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNkLE9BQU8sRUFBRSxDQUFBO1FBQ1gsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFBO0lBQ1YsQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDO0FBTkQsb0JBTUM7QUFFWSxRQUFBLFlBQVksR0FBRyxDQUFDLEVBQVUsRUFBRSxjQUFzQixFQUFFLGVBQXVCLEVBQXFCLEVBQUU7SUFDN0csTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDeEQsT0FBTyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUM7SUFDaEIsT0FBTyxDQUFDLEtBQUssR0FBRyxjQUFjLENBQUM7SUFDL0IsT0FBTyxDQUFDLE1BQU0sR0FBRyxlQUFlLENBQUM7SUFFakMsT0FBTyxPQUFPLENBQUM7QUFDakIsQ0FBQyxDQUFDIn0=","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Scene_1 = __importDefault(require(\"./Scene\"));\nconst Sprite_1 = __importDefault(require(\"./Sprite\"));\nconst utils_1 = require(\"./utils/utils\");\nconst utils_2 = require(\"../utils/utils\");\nconst screenSpace = 32;\nconst defaultGlobalConfig = {\n    type: 'scroll',\n    lifeTime: 200,\n};\nconst defaultSpriteConfig = {\n    fontSize: 36,\n    fontColor: '#fff',\n    fontFamily: 'Microsoft YaHei',\n    avatarSize: 50,\n    type: 'text',\n    padding: [12, 12, 12, 12],\n    radius: 20,\n};\nclass Barrage {\n    constructor(container, globalConfig = {}) {\n        this.resize = () => {\n            const globalConfig = this.calcData();\n            const { containerHeight, containerWidth, } = globalConfig;\n            this.globalConfig.canvas.width = containerWidth;\n            this.globalConfig.canvas.height = containerHeight;\n            this.globalConfig.templateCanvas.width = containerWidth;\n            this.globalConfig.templateCanvas.height = containerHeight;\n            this.scene.resetGlobalConfig(globalConfig);\n        };\n        this.globalConfig = utils_1.mixConfig(globalConfig, defaultGlobalConfig);\n        this.container = container;\n        this.globalConfig.canvas = this.initCanvas(true);\n        this.globalConfig.templateCanvas = this.initCanvas();\n        this.globalConfig.templateCtx = this.globalConfig.templateCanvas.getContext('2d');\n        this.globalConfig.ctx = this.globalConfig.canvas.getContext('2d');\n        this.globalConfig = Object.assign(Object.assign({}, this.globalConfig), this.calcData());\n        // 创建场景\n        this.scene = new Scene_1.default(this.globalConfig);\n        this.stop = this.scene.stop.bind(this.scene);\n        this.start = this.scene.start.bind(this.scene);\n        this.clear = this.scene.clear.bind(this.scene);\n        window.addEventListener('resize', this.resize);\n    }\n    add(spriteConfig) {\n        spriteConfig = utils_1.mixConfig(spriteConfig, defaultSpriteConfig);\n        if (!spriteConfig.fontColor) {\n            spriteConfig.fontColor = utils_1.getRandomColor();\n        }\n        this.scene.add(new Sprite_1.default(spriteConfig, this.globalConfig));\n    }\n    destroy() {\n        this.scene.destroy();\n        window.removeEventListener('resize', this.resize);\n    }\n    initCanvas(isTemplate = false) {\n        const { offsetWidth, offsetHeight } = this.container;\n        const canvas = utils_2.createCanvas('canvas-huiyidun', offsetWidth, offsetHeight);\n        if (isTemplate) {\n            canvas.style.position = 'absolute';\n            canvas.style.display = 'block';\n            this.container.append(canvas);\n        }\n        return canvas;\n    }\n    calcData() {\n        const { offsetWidth: containerWidth, offsetHeight: containerHeight, } = this.container;\n        // 轨道Y轴返回\n        const trackRange = [screenSpace, containerHeight - screenSpace];\n        return {\n            containerHeight,\n            containerWidth,\n            trackRange,\n        };\n    }\n}\nexports.default = Barrage;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLG9EQUE0QjtBQUM1QixzREFBOEI7QUFFOUIseUNBQXdEO0FBQ3hELDBDQUE0QztBQUU1QyxNQUFNLFdBQVcsR0FBRyxFQUFFLENBQUM7QUFFdkIsTUFBTSxtQkFBbUIsR0FBa0I7SUFDekMsSUFBSSxFQUFFLFFBQVE7SUFDZCxRQUFRLEVBQUUsR0FBRztDQUNkLENBQUM7QUFFRixNQUFNLG1CQUFtQixHQUFrQjtJQUN6QyxRQUFRLEVBQUUsRUFBRTtJQUNaLFNBQVMsRUFBRSxNQUFNO0lBQ2pCLFVBQVUsRUFBRSxpQkFBaUI7SUFDN0IsVUFBVSxFQUFFLEVBQUU7SUFDZCxJQUFJLEVBQUUsTUFBTTtJQUNaLE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUN6QixNQUFNLEVBQUUsRUFBRTtDQUNYLENBQUM7QUFFRixNQUFNLE9BQU87SUFTWCxZQUFtQixTQUFzQixFQUFFLGVBQThCLEVBQUU7UUEwQ25FLFdBQU0sR0FBRyxHQUFHLEVBQUU7WUFDcEIsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ3JDLE1BQU0sRUFDSixlQUFlLEVBQ2YsY0FBYyxHQUNmLEdBQUcsWUFBWSxDQUFDO1lBRWpCLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxjQUFjLENBQUM7WUFDaEQsSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLGVBQWUsQ0FBQztZQUNsRCxJQUFJLENBQUMsWUFBWSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEdBQUcsY0FBYyxDQUFDO1lBQ3hELElBQUksQ0FBQyxZQUFZLENBQUMsY0FBYyxDQUFDLE1BQU0sR0FBRyxlQUFlLENBQUM7WUFFMUQsSUFBSSxDQUFDLEtBQUssQ0FBQyxpQkFB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","import Barrage from '../packages/Barrage';\n\nwindow.barrage = new Barrage(\n  document.getElementById('webgl'),\n  {\n    type: \"scroll\"\n  }\n);\nlet count = 0;\n\nwindow.add = () => {\n  window.timer = setInterval(() => {\n    window.barrage.add({\n      content: '李四：你好呀 🤘🏻111',\n      avatar: 'http://thirdwx.qlogo.cn/mmopen/vi_32/JqfbL9Z2prhybabOMfPUELUQAichrtTLCWFCUr6hTicMCE77qwSPsHm7wRNpzPY2kdG3RrlLco6shVAiatGtsIDgw/132',\n    });\n    count += 1;\n    if (count > 500) {\n      clearInterval(window.time);\n    }\n  }, 100);\n};\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst TrackManager_1 = __importDefault(require(\"./utils/TrackManager\"));\nclass Scene {\n    constructor(globalConfig) {\n        this.timer = null;\n        // 精灵实例map\n        this.spriteInstances = {};\n        // 需要加入的精灵\n        this.needAddSpriteList = [];\n        this.run = () => {\n            this.tryToAddSprite();\n            this.render();\n            this.timer = window.requestAnimationFrame(this.run);\n        };\n        this.globalConfig = globalConfig;\n        this.trackManger = new TrackManager_1.default(globalConfig);\n        this.start();\n    }\n    calcAnimation(rect, top = 12) {\n        const [barrageWidth] = rect;\n        if (this.globalConfig.type === 'reversescroll') {\n            const speedX = (this.globalConfig.containerWidth + barrageWidth) / this.globalConfig.lifeTime;\n            return {\n                position: [-barrageWidth, top],\n                speed: [speedX, 0],\n                rangeWidth: [-barrageWidth, this.globalConfig.containerWidth + barrageWidth]\n            };\n        }\n        // scroll\n        const speedX = -(this.globalConfig.containerWidth + barrageWidth) / this.globalConfig.lifeTime;\n        return {\n            position: [this.globalConfig.containerWidth, top],\n            speed: [speedX, 0],\n            rangeWidth: [-barrageWidth, this.globalConfig.containerWidth],\n        };\n    }\n    add(sprite) {\n        this.needAddSpriteList.push(sprite);\n    }\n    addSprite(sprite, top) {\n        sprite.setAnimation(this.calcAnimation(sprite.size, top));\n        this.spriteInstances[sprite.id] = sprite;\n    }\n    tryToAddSprite() {\n        if (this.needAddSpriteList.length === 0) {\n            return;\n        }\n        const [sprite] = this.needAddSpriteList;\n        const top = this.trackManger.applyPosition(sprite);\n        if (top) {\n            this.addSprite(sprite, top);\n            this.needAddSpriteList.shift();\n        }\n    }\n    resetGlobalConfig(globalConfig) {\n        this.globalConfig = Object.assign(Object.assign({}, this.globalConfig), globalConfig);\n    }\n    start() {\n        if (!this.timer) {\n            this.run();\n        }\n    }\n    stop() {\n        if (this.timer) {\n            window.cancelAnimationFrame(this.timer);\n            this.timer = null;\n        }\n    }\n    clear() {\n        this.spriteInstances = {};\n    }\n    destroy() {\n        this.stop();\n        this.clear();\n    }\n    drawTemplateCanvas() {\n        this.globalConfig.templateCtx.clearRect(0, 0, this.globalConfig.containerWidth, this.globalConfig.containerHeight);\n        Object.keys(this.spriteInstances).forEach(uid => {\n            try {\n                const sprite = this.spriteInstances[uid];\n                sprite.animation();\n                this.trackManger.removeEmployWithNotEmploy(sprite);\n                if (!sprite.status) {\n                    delete this.spriteInstances[uid];\n                }\n                else {\n                    sprite.render(this.globalConfig.templateCtx);\n                }\n            }\n            catch (e) {\n            }\n        });\n    }\n    render() {\n        this.drawTemplateCanvas();\n        this.globalConfig.ctx.clearRect(0, 0, this.globalConfig.containerWidth, this.globalConfig.containerHeight);\n        this.globalConfig.ctx.drawImage(this.globalConfig.templateCanvas, 0, 0);\n    }\n}\nexports.default = Scene;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2NlbmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJTY2VuZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUVBLHdFQUFnRDtBQUVoRCxNQUFNLEtBQUs7SUFZVCxZQUFtQixZQUEyQjtRQVJ0QyxVQUFLLEdBQUcsSUFBSSxDQUFDO1FBRXJCLFVBQVU7UUFDRixvQkFBZSxHQUE0QixFQUFFLENBQUM7UUFFdEQsVUFBVTtRQUNGLHNCQUFpQixHQUFhLEVBQUUsQ0FBQztRQWtGakMsUUFBRyxHQUFHLEdBQUcsRUFBRTtZQUNqQixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDdEIsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ2QsSUFBSSxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3RELENBQUMsQ0FBQztRQW5GQSxJQUFJLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztRQUNqQyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksc0JBQVksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUVsRCxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDZixDQUFDO0lBRU8sYUFBYSxDQUFDLElBQUksRUFBRSxHQUFHLEdBQUcsRUFBRTtRQUNsQyxNQUFNLENBQUMsWUFBWSxDQUFDLEdBQUcsSUFBSSxDQUFDO1FBRTVCLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLEtBQUssZUFBZSxFQUFFO1lBQzlDLE1BQU0sTUFBTSxHQUFHLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxjQUFjLEdBQUcsWUFBWSxDQUFDLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUM7WUFDOUYsT0FBTztnQkFDTCxRQUFRLEVBQUUsQ0FBQyxDQUFDLFlBQVksRUFBRSxHQUFHLENBQUM7Z0JBQzlCLEtBQUssRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7Z0JBQ2xCLFVBQVUs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","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst employTrackSpaceY = 20;\nclass TrackManager {\n    constructor(globalConfig) {\n        // 占用的轨道\n        this.employTrack = {};\n        this.globalConfig = globalConfig;\n    }\n    getCanUseTrack(employTrack, allTrack, height) {\n        const spaceTracks = [];\n        if (employTrack.length !== 0) {\n            const useTrack = employTrack\n                .map(range => (range.split(',').map(value => parseFloat(value))))\n                .sort((a, b) => (a[0] > b[0] ? 1 : -1));\n            const tracks = [];\n            useTrack.forEach((track, index) => {\n                if (index === 0) {\n                    tracks.push(track);\n                    return;\n                }\n                const prevTrack = tracks[tracks.length - 1];\n                const [min, max] = track;\n                if (prevTrack[1] + employTrackSpaceY > min) {\n                    prevTrack[1] = max;\n                    return;\n                }\n                tracks.push(track);\n            });\n            const [start] = tracks[0];\n            const [, end] = tracks[tracks.length - 1];\n            if (allTrack[0] < start) {\n                spaceTracks.push([allTrack[0], start]);\n            }\n            if (allTrack[1] > end) {\n                spaceTracks.push([end, allTrack[1]]);\n            }\n            if (tracks.length > 1) {\n                let startTrack;\n                tracks.forEach(track => {\n                    if (startTrack === undefined) {\n                        startTrack = track[1];\n                    }\n                    else {\n                        spaceTracks.push([startTrack, track[0]]);\n                        startTrack = track[0];\n                    }\n                });\n            }\n        }\n        else {\n            spaceTracks.push([...allTrack]);\n        }\n        for (let i = 0; i < spaceTracks.length; i += 1) {\n            const spaceTrack = spaceTracks[i];\n            if (spaceTrack[1] - spaceTrack[0] > height + employTrackSpaceY) {\n                return [spaceTrack[0], spaceTrack[0] + height + employTrackSpaceY];\n            }\n        }\n        return null;\n    }\n    // 申请轨道\n    applyPosition(sprite) {\n        const employ = Object.values(this.employTrack);\n        const [, height] = sprite.size;\n        const employTrackPosition = this.getCanUseTrack(employ, this.globalConfig.trackRange, height);\n        if (!employTrackPosition) {\n            return null;\n        }\n        this.employTrack[sprite.id] = employTrackPosition.toString();\n        sprite.employTrack = true;\n        return employTrackPosition[0];\n    }\n    // 删除占用轨道\n    removeEmployWithNotEmploy(sprite) {\n        if (!sprite.employTrack && this.employTrack[sprite.id]) {\n            delete this.employTrack[sprite.id];\n        }\n    }\n}\nexports.default = TrackManager;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVHJhY2tNYW5hZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiVHJhY2tNYW5hZ2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBR0EsTUFBTSxpQkFBaUIsR0FBRyxFQUFFLENBQUM7QUFFN0IsTUFBTSxZQUFZO0lBR2hCLFlBQW1CLFlBQTJCO1FBSTlDLFFBQVE7UUFDQSxnQkFBVyxHQUFtQyxFQUFFLENBQUM7UUFKdkQsSUFBSSxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7SUFDbkMsQ0FBQztJQUtPLGNBQWMsQ0FBQyxXQUFXLEVBQUUsUUFBUSxFQUFFLE1BQU07UUFDbEQsTUFBTSxXQUFXLEdBQUcsRUFBRSxDQUFDO1FBRXZCLElBQUksV0FBVyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDNUIsTUFBTSxRQUFRLEdBQUcsV0FBVztpQkFDekIsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FDWixLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUNqRCxDQUFDO2lCQUNELElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQ2QsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDckIsQ0FBQyxDQUFDO1lBRUwsTUFBTSxNQUFNLEdBQUcsRUFBRSxDQUFDO1lBQ2xCLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUU7Z0JBQ2hDLElBQUksS0FBSyxLQUFLLENBQUMsRUFBRTtvQkFDZixNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO29CQUNuQixPQUFPO2lCQUNSO2dCQUVELE1BQU0sU0FBUyxHQUFH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","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst loadImage_1 = __importDefault(require(\"./utils/loadImage\"));\nconst DrawManager_1 = __importDefault(require(\"./utils/DrawManager\"));\nconst utils_1 = require(\"../utils/utils\");\nconst employTrackSpaceX = 20;\nclass Sprite {\n    constructor(spriteConfig, globalConfig) {\n        this.status = true;\n        this.position = null;\n        this.speed = [1, 1];\n        // 占用起飞跑道标志\n        this.employTrack = false;\n        this.getImageData = () => {\n            this.templateCtx = this.templateCanvas.getContext('2d');\n            this.templateCtx.clearRect(0, 0, this.size[0], this.size[1]);\n            this.drawManager.draw(this.templateCtx, {\n                avatarImage: this.avatarImage,\n                size: this.size\n            });\n        };\n        this.id = utils_1.createId('s-');\n        this.spriteConfig = spriteConfig;\n        this.globalConfig = globalConfig;\n        this.drawManager = new DrawManager_1.default(spriteConfig, globalConfig);\n        this.size = this.drawManager.calcSize();\n        this.templateCanvas = utils_1.createCanvas(this.id, this.size[0], this.size[1]);\n        if (this.spriteConfig.avatar) {\n            loadImage_1.default(this.spriteConfig.avatar, avatarImage => {\n                this.avatarImage = avatarImage;\n                this.getImageData();\n            });\n        }\n        this.getImageData();\n    }\n    render(ctx) {\n        ctx.drawImage(this.templateCanvas, ...this.position);\n    }\n    // 设置关于运动的参数\n    setAnimation({ position, speed, rangeWidth }) {\n        this.position = position;\n        this.speed = speed;\n        this.rangeWidth = rangeWidth;\n    }\n    checkEmployTrack(left) {\n        if (this.globalConfig.type === 'reversescroll') {\n            if (left > employTrackSpaceX) {\n                return false;\n            }\n        }\n        if (this.globalConfig.type === 'scroll') {\n            const [width] = this.size;\n            if (left < this.globalConfig.containerWidth - width - employTrackSpaceX) {\n                return false;\n            }\n        }\n        return true;\n    }\n    animation() {\n        if (!this.position) {\n            return;\n        }\n        const left = this.position[0] + this.speed[0];\n        const top = this.position[1] + this.speed[1];\n        const offsetWidth = (this.rangeWidth &&\n            (this.rangeWidth[0] > left ||\n                this.rangeWidth[1] < left));\n        if (offsetWidth) {\n            this.status = false;\n            return;\n        }\n        this.position = [left, top];\n        if (this.employTrack) {\n            this.employTrack = this.checkEmployTrack(left);\n        }\n    }\n    remove() {\n        this.status = false;\n    }\n}\nexports.default = Sprite;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3ByaXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiU3ByaXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0Esa0VBQTBDO0FBQzFDLHNFQUE4QztBQUM5QywwQ0FBc0Q7QUFFdEQsTUFBTSxpQkFBaUIsR0FBRyxFQUFFLENBQUM7QUFFN0IsTUFBTSxNQUFNO0lBdUJWLFlBQW1CLFlBQTJCLEVBQUUsWUFBMkI7UUFyQnBFLFdBQU0sR0FBWSxJQUFJLENBQUM7UUFDdEIsYUFBUSxHQUFxQixJQUFJLENBQUM7UUFFbEMsVUFBSyxHQUFxQixDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQVl6QyxXQUFXO1FBQ0osZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUF3Qm5CLGlCQUFZLEdBQUcsR0FBRyxFQUFFO1lBQzFCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDeEQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3RCxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO2dCQUN0QyxXQUFXLEVBQUUsSUFBSSxDQUFDLFdBQVc7Z0JBQzdCLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTthQUNBLENBQUMsQ0FBQztRQUNyQixDQUFDLENBQUM7UUF6QkEsSUFBSSxDQUFDLEVBQUUsR0FBRyxnQkFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRXpCLElBQUksQ0FBQyxZQUFZLEdBQUcsWUFBWSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxZQUFZLEdBQUcsWUFBWSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxxQkFBVyxDQUFD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","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst cacheImages = {};\nfunction loadImage(src, onload, onError) {\n    if (cacheImages[src]) {\n        onload(cacheImages[src]);\n        return;\n    }\n    const image = new Image();\n    image.crossOrigin = '';\n    image.src = src;\n    image.onload = () => {\n        cacheImages[src] = image;\n        onload(cacheImages[src]);\n    };\n    image.onerror = onError || function () {\n    };\n}\nexports.default = loadImage;\n;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9hZEltYWdlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibG9hZEltYWdlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTSxXQUFXLEdBQXVDLEVBQUUsQ0FBQztBQUUzRCxTQUF3QixTQUFTLENBQUMsR0FBVyxFQUFFLE1BQXdDLEVBQUUsT0FBb0I7SUFDM0csSUFBSSxXQUFXLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDcEIsTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3pCLE9BQU07S0FDUDtJQUVELE1BQU0sS0FBSyxHQUFHLElBQUksS0FBSyxFQUFFLENBQUM7SUFDMUIsS0FBSyxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7SUFDdkIsS0FBSyxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUM7SUFDaEIsS0FBSyxDQUFDLE1BQU0sR0FBRyxHQUFHLEVBQUU7UUFDbEIsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUN6QixNQUFNLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDM0IsQ0FBQyxDQUFDO0lBQ0YsS0FBSyxDQUFDLE9BQU8sR0FBRyxPQUFPLElBQUk7SUFDM0IsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQWZELDRCQWVDO0FBQUEsQ0FBQyJ9","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst imageAndTextSpace = 12;\nclass DrawManager {\n    constructor(spriteConfig, globalConfig) {\n        this.globalConfig = globalConfig;\n        this.spriteConfig = spriteConfig;\n    }\n    calcSize() {\n        const [paddingTop, paddingRight, paddingBottom, paddingLeft] = this.spriteConfig.padding;\n        this.globalConfig.ctx.save();\n        this.globalConfig.ctx.font = `${this.spriteConfig.fontSize}px ${this.spriteConfig.fontFamily}`;\n        const measureText = this.globalConfig.ctx.measureText(this.spriteConfig.content);\n        this.globalConfig.ctx.restore();\n        const barrageAllWidth = (this.spriteConfig.avatarSize + imageAndTextSpace + measureText.width +\n            paddingLeft + paddingRight);\n        const barrageAllHeight = (Math.max(this.spriteConfig.avatarSize, this.spriteConfig.fontSize) +\n            paddingTop + paddingBottom);\n        return [Math.floor(barrageAllWidth), barrageAllHeight];\n    }\n    draw(ctx, options) {\n        const [, , left] = this.spriteConfig.padding;\n        // 头像\n        const avatarSpaceTop = (options.size[1] - this.spriteConfig.avatarSize) / 2;\n        if (options.avatarImage && typeof options.avatarImage !== 'string') {\n            DrawManager.drawAvatar(ctx, {\n                img: options.avatarImage,\n                position: [left, avatarSpaceTop],\n                imageHeight: this.spriteConfig.avatarSize,\n                imageWidth: this.spriteConfig.avatarSize,\n                radius: this.spriteConfig.radius,\n            });\n        }\n        else {\n            // todo 留出位置\n        }\n        const textSpaceTop = (options.size[1] - this.spriteConfig.fontSize - 5) / 2;\n        this.drawText(ctx, {\n            left: this.spriteConfig.avatarSize + imageAndTextSpace + left,\n            top: textSpaceTop\n        });\n        DrawManager.drawBorder(ctx, options);\n    }\n    static drawBorder(ctx, options) {\n        const [barrageAllWidth, barrageAllHeight] = options.size;\n        //x轴方向的阴影偏移量,负数为向右偏移量\n        ctx.shadowOffsetX = 3;\n        //y轴方向的阴影偏移量,负数为向上偏移量\n        ctx.shadowOffsetY = 3;\n        //阴影模糊强度\n        ctx.shadowBlur = 12;\n        ctx.shadowColor = \"rgba(46, 141, 239, 0.4)\";\n        ctx.strokeStyle = 'rgba(46, 141, 239, 1)';\n        ctx.strokeRect(0, 0, barrageAllWidth, barrageAllHeight);\n    }\n    static drawAvatar(ctx, roundImageArgs) {\n        const { img, imageWidth, imageHeight, position, } = roundImageArgs;\n        let { radius } = roundImageArgs;\n        radius = radius > Math.max(imageWidth, imageHeight) / 2 ? Math.max(imageHeight, imageWidth) / 2 : radius;\n        const [x, y] = position;\n        ctx.save();\n        if (img) {\n            ctx.beginPath();\n            ctx.moveTo(x + radius, y);\n            ctx.lineTo(x + imageWidth - radius, y);\n            ctx.quadraticCurveTo(x + imageWidth, y, x + imageWidth, y + radius);\n            ctx.lineTo(x + imageWidth, y + imageHeight - radius);\n            ctx.quadraticCurveTo(x + imageWidth, y + imageHeight, x + imageWidth - radius, y + imageHeight);\n            ctx.lineTo(x + radius, y + imageHeight);\n            ctx.quadraticCurveTo(x, y + imageHeight, x, y + imageHeight - radius);\n            ctx.lineTo(x, y + radius);\n            ctx.quadraticCurveTo(x, y, x + radius, y);\n            ctx.closePath();\n            ctx.clip();\n            const { width, height } = img;\n            ctx.drawImage(img, 0, 0, width, height, x, y, imageWidth, imageHeight);\n        }\n        else {\n        }\n        ctx.restore();\n    }\n    ;\n    drawText(ctx, { left = 0, top = 0 }) {\n        ctx.fillStyle = this.spriteConfig.fontColor;\n        ctx.font = `${this.spriteConfig.fontSize}px ${this.spriteConfig.fontFamily}`;\n        ctx.textAlign = 'left';\n        ctx.textBaseline = 'top';\n        ctx.fillText(this.spriteConfig.content, left, top);\n    }\n}\nexports.default = DrawManager;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRHJhd01hbmFnZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJEcmF3TWFuYWdlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVBLE1BQU0saUJBQWlCLEdBQUcsRUFBRSxDQUFDO0FBRTdCLE1BQU0sV0FBVztJQUlmLFlBQW1CLFlBQTJCLEVBQUUsWUFBMkI7UUFDekUsSUFBSSxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7UUFDakMsSUFBSSxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7SUFDbkMsQ0FBQztJQUVNLFFBQVE7UUFDYixNQUFNLENBQUMsVUFBVSxFQUFFLFlBQVksRUFBRSxhQUFhLEVBQUUsV0FBVyxDQUFDLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUM7UUFDekYsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDN0IsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsSUFBSSxHQUFHLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUMvRixNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNqRixJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUVoQyxNQUFNLGVBQWUsR0FBRyxDQUN0QixJQUFJLENBQUMsWUFBWSxDQUFDLFVBQVUsR0FBRyxpQkFBaUIsR0FBRyxXQUFXLENBQUMsS0FBSztZQUNwRSxXQUFXLEdBQUcsWUFBWSxDQUMzQixDQUFDO1FBRUYsTUFBTSxnQkFBZ0IsR0FBRyxDQUN2QixJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsUUFBUSxD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","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getRandomColor = () => ('rgb(' + parseInt(String(Math.random() * 255)) + ','\n    + parseInt(String(Math.random() * 255)) + ','\n    + parseInt(String(Math.random() * 255)) + ')');\nexports.mixConfig = (config, defaultConfig) => {\n    Object.keys(defaultConfig).forEach(key => {\n        if (typeof config[key] === 'undefined') {\n            config[key] = defaultConfig[key];\n        }\n    });\n    return config;\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ1dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFhLFFBQUEsY0FBYyxHQUFHLEdBQVcsRUFBRSxDQUFDLENBQzFDLE1BQU0sR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxHQUFHLENBQUMsQ0FBQyxHQUFHLEdBQUc7TUFDbEQsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHO01BQzNDLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLEdBQUcsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUM5QyxDQUFDO0FBRVcsUUFBQSxTQUFTLEdBQUcsQ0FBQyxNQUFNLEVBQUUsYUFBYSxFQUFFLEVBQUU7SUFDakQsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDdkMsSUFBSSxPQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxXQUFXLEVBQUU7WUFDdEMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUNsQztJQUNILENBQUMsQ0FBQyxDQUFDO0lBRUgsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQyxDQUFDIn0="],"sourceRoot":""}